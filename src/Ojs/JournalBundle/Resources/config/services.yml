services:
  ojs.journal_service:
    class: Ojs\JournalBundle\Service\JournalService
    arguments:
      - "@doctrine.orm.entity_manager"
      - "@session"
      - "@router"
      - "@security.token_storage"
      - "@request_stack"
      - "%defaultPublisherSlug%"

  journal.orm_event_listener:
    class: Ojs\JournalBundle\Listeners\AclOrmListener
    arguments: ["@service_container"]
    tags:
        - { name: doctrine.event_listener, event: postPersist }

  form.type.journal_users_type:
    class: Ojs\JournalBundle\Form\Type\JournalUsersFieldType
    arguments: ["@ojs.journal_service"]
    tags:
        - { name: form.type, alias: journal_users_type }

  ojs.serializationlistener:
    class: Ojs\CoreBundle\Listeners\SerializationListener
    arguments: []
    tags:
        - { name: jms_serializer.event_subscriber }
  ojs.journal.subscription_subscriber:
    class: Ojs\JournalBundle\Listeners\SubscriptionSubscriber
    arguments: ["@doctrine.orm.entity_manager", "@ojs_mailer"]
    tags:
      - { name: kernel.event_subscriber }

  ojs.mail_listener.journal_item:
    class: Ojs\JournalBundle\Listeners\AbstractJournalItemMailer
    abstract: true
    arguments: ["@ojs_mailer", "@doctrine", "@security.token_storage"]

  ojs.mail_listener.journal:
    class: Ojs\JournalBundle\Listeners\JournalMailer
    parent: ojs.mail_listener.journal_item
    tags:
      - { name: kernel.event_subscriber }

  ojs.mail_listener.article:
    class: Ojs\JournalBundle\Listeners\ArticleMailer
    parent: ojs.mail_listener.journal_item
    tags:
      - { name: kernel.event_subscriber }

  ojs.mail_listener.journal_announcement:
    class: Ojs\JournalBundle\Listeners\JournalAnnouncementMailer
    parent: ojs.mail_listener.journal_item
    tags:
      - { name: kernel.event_subscriber }

  ojs.mail_listener.journal_post:
    class: Ojs\JournalBundle\Listeners\JournalPostMailer
    parent: ojs.mail_listener.journal_item
    tags:
      - { name: kernel.event_subscriber }

  ojs.mail_listener.journal_page:
    class: Ojs\JournalBundle\Listeners\JournalPageMailer
    parent: ojs.mail_listener.journal_item
    tags:
      - { name: kernel.event_subscriber }

  ojs.mail_listener.issue:
    class: Ojs\JournalBundle\Listeners\IssueMailer
    parent: ojs.mail_listener.journal_item
    tags:
      - { name: kernel.event_subscriber }

  ojs.mail_listener.section:
    class: Ojs\JournalBundle\Listeners\SectionMailer
    parent: ojs.mail_listener.journal_item
    tags:
      - { name: kernel.event_subscriber }

  ojs.mail_listener.board:
    class: Ojs\JournalBundle\Listeners\BoardMailer
    parent: ojs.mail_listener.journal_item
    tags:
      - { name: kernel.event_subscriber }

  ojs.mail_listener.journal_contact:
    class: Ojs\JournalBundle\Listeners\JournalContactMailer
    parent: ojs.mail_listener.journal_item

  ojs.mail_listener.journal_index:
    class: Ojs\JournalBundle\Listeners\JournalIndexMailer
    parent: ojs.mail_listener.journal_item
    tags:
      - { name: kernel.event_subscriber }

  ojs.mail_listener.journal_submission_file:
    class: Ojs\JournalBundle\Listeners\JournalSubmissionFileMailer
    parent: ojs.mail_listener.journal_item
    tags:
      - { name: kernel.event_subscriber }

  ojs.mail_listener.journal_submission_checklist:
    class: Ojs\JournalBundle\Listeners\JournalSubmissionChecklistMailer
    parent: ojs.mail_listener.journal_item
    tags:
      - { name: kernel.event_subscriber }

  ojs.mail_listener.journal_user:
    class: Ojs\JournalBundle\Listeners\JournalUserMailer
    parent: ojs.mail_listener.journal_item
    tags:
      - { name: kernel.event_subscriber }

#  journal.numerator_orm_subscriber:
#    class: Ojs\JournalBundle\Listeners\NumeratorOrmSubscriber
#    tags:
#        - { name: doctrine.event_listener, event: postPersist }

  ojs_journal.article_events:
    class: Ojs\JournalBundle\Event\Article\ArticleEvents

  ojs_journal.board_events:
    class: Ojs\JournalBundle\Event\Board\BoardEvents

  ojs_journal.design_events:
    class: Ojs\JournalBundle\Event\Design\DesignEvents

  ojs_journal.index_events:
    class: Ojs\JournalBundle\Event\Index\IndexEvents

  ojs_journal.issue_events:
    class: Ojs\JournalBundle\Event\Issue\IssueEvents

  ojs_journal.journal_events:
    class: Ojs\JournalBundle\Event\Journal\JournalEvents

  ojs_journal.journal_announcement_events:
    class: Ojs\JournalBundle\Event\JournalAnnouncement\JournalAnnouncementEvents

  ojs_journal.journal_contact_events:
    class: Ojs\JournalBundle\Event\JournalContact\JournalContactEvents

  ojs_journal.journal_index_events:
    class: Ojs\JournalBundle\Event\JournalIndex\JournalIndexEvents

  ojs_journal.journal_page_events:
    class: Ojs\JournalBundle\Event\JournalPage\JournalPageEvents

  ojs_journal.journal_post_events:
    class: Ojs\JournalBundle\Event\JournalPost\JournalPostEvents

  ojs_journal.journal_submission_checklist_events:
    class: Ojs\JournalBundle\Event\JournalSubmissionChecklist\JournalSubmissionChecklistEvents

  ojs_journal.journal_submission_file_events:
    class: Ojs\JournalBundle\Event\JournalSubmissionFile\JournalSubmissionFileEvents

  ojs_journal.journal_user_events:
    class: Ojs\JournalBundle\Event\JournalUser\JournalUserEvents

  ojs_journal.section_events:
    class: Ojs\JournalBundle\Event\Section\SectionEvents

  ojs_journal.submission_checklist_events:
    class: Ojs\JournalBundle\Event\SubmissionChecklist\SubmissionChecklistEvents

  ojs_journal.theme_events:
    class: Ojs\JournalBundle\Event\Theme\ThemeEvents

  ojs_journal.citation_events:
    class: Ojs\JournalBundle\Event\CitationEvents

  ojs_journal.menu_events:
    class: Ojs\JournalBundle\Event\MenuEvents

  ojs_journal.workflow_events:
    class: Ojs\JournalBundle\Event\WorkflowEvents
